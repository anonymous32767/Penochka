<!doctype html>
<html>
<head>
  <title>dispatcher &#8212; Диспетчеризация пеночки</title>
  <link href="style.css" type="text/css" rel="stylesheet" />
</head>
<body>
<h1>dispatcher &#8212; Диспетчеризация пеночки</h1>
<p class="abstract">Запуск скрипта. Мост между браузерной системой событий и внутренними событиями пеночки</p>
<p>TODO: Рассказать про это все.</p>

<p><pre>   try { document = unsafeWindow.document } catch (err) {}

   /* Sending event 'domain name'. E.g. for www.2-ch.ru $.to('2-ch.ru')
      will be sent */
   $.to(location.host, 1)

	/* GUI messages */
   $.on(
	   'click',
		function (e) {
			var subj = $(e.target)
			if (subj.attr('penmsg')) {
				$.to(subj.attr('penmsg'), subj)
				return null
			} else {
				return e
			}
		})

	$.timer.check('Загрузка скрипта')

   /* DOM Startup */
   $.on('ready', function () {

      $(document).click(
         function (e) {
            return $.to('click', e)
         })
      document.addEventListener(
         'mouseover', function (e) {
            return $.to('mouseover', e)
         }, true)
      document.addEventListener(
         'mouseout', function (e) {
            return $.to('mouseout', e)
         }, true)
      $(document).submit(
         function (e) {
            return $.to('submit', e)
         })

		$.timer.check('Установка событий')

		$.insertInFooter('<a href="" title="' + 
							  $.timer.cache + ' Итого: ' + 
							  $.timer.total + 'мсек">пеночка</a>')
   })

   var _jq = $

	try { 
		var dummy = unsafeWindow
		$.timer.init()
		$.to('ready',1)
	} catch (e) { 
		$(function () {
			if (!$.timer)
				$ = _jq.noConflict(true)
			$.timer.init()
			$.to('ready',1)}) }</pre></p>
</body></html>
